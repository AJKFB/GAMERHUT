<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="UTF-8">
  <title>متجر الألعاب</title>
  <link rel="stylesheet" href="style.css">
  <!-- أنماط CSS المدمجة -->
  <style>
    /* النمط العام للجسم */
    body {
      font-family: 'Tahoma', sans-serif;
      margin: 0;
      padding: 0;
      background: #201b1b00;
      color: #333;
      line-height: 1.8;
    }
    /* تنسيق الهيدر والقائمة */
    header {
      padding: 1rem 0;
      background: linear-gradient(to right,  #2a006e, #1e043d) ;
      color: rgba(46, 40, 40, 0.11);
      padding: 2rem 0;
      text-align: center;
    }
    nav {
      display: flex;
      justify-content: center;
      gap: 30px;
      padding: 1rem 0;
      flex-wrap: wrap;
    }
    nav a,
    .cta-button,
    .btn {
      color: white;
      text-decoration: none;
      font-size: 20px;
      padding: 10px 20px;
      border-radius: 8px;
      transition: background 0.3s;
      border: none;
      cursor: pointer;
    }
    nav a:hover,
    .cta-button:hover,
    .btn:hover {
      background: #3c43a4;
    }
    /* الحاويات والأقسام */
    .container {
      padding: 40px 20px;
      text-align: center;
    }
    .section {
      margin-bottom: 60px;
    }
    /* تنسيق المنتجات */
    .product, .product-container {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
      text-align: center;
      transition: transform 0.3s;
      display: inline-block;
      margin: 10px;
      vertical-align: top;
    }
    .product img, .product-container img {
      width: 100%;
      max-width: 300px;
      border-radius: 12px;
    }
    .product:hover, .product-container:hover {
      transform: translateY(-8px);
    }
    .product h3, .product-container .product-title {
      margin: 15px 0 10px;
    }
    .product p, .product-container p {
      color: #666;
    }
    /* زرّ البحث */
    #searchBox {
      width: 50%;
      padding: 10px;
      margin-bottom: 20px;
      border: 2px solid #4e54c8;
      border-radius: 8px;
      font-size: 16px;
    }
    /* صندوق الملاحظة */
    .notice-box {
      background: linear-gradient(to right, #ffd700, #ffa500);
      color: #333;
      padding: 15px;
      font-size: 18px;
      text-align: center;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin: 20px 0;
      animation: fadeIn 1s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    /* تنسيق الصور العامة */
    img {
      width: 100%;
      max-width: 250px;
      height: auto;
      border-radius: 8px;
    }
header {
  display: flex;
  justify-content: space-between; /* الشعار يسار، الباقي يمين */
  align-items: center;
  padding: 10px 20px;
  background-color: #f5f5f5;
}

#logo-img {
  height: 30px;
  width: auto;
  cursor: pointer;
  order: -1; /* للتأكد أنه يظهر أولاً على اليسار */
}
.cart-wrapper {
  position: fixed;
  top: 10px;
  right: 15px;
  width: 50px;
  height: 50px;
  cursor: pointer;
  z-index: 1000;
}

.cart-image {
  width: 100%;
  height: auto;
}

.cart-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  background-color: red;
  color: white;
  font-size: 12px;
  padding: 3px 6px;
  border-radius: 50%;
  font-weight: bold;
}
.flash-messages .alert {
  background: #d4edda;
  color: #155724;
  padding: 10px;
  margin: 10px auto;
  width: 90%;
  border-radius: 8px;
  text-align: center;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.user-menu {
  position: fixed;
  top: 15px;
  left: 15px;
  z-index: 1000;
}

.user-menu button {
  background: #fff;
  border: 1px solid #ccc;
  padding: 8px 12px;
  border-radius: 50%;
  font-size: 18px;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.menu-content {
  display: none;
  position: absolute;
  top: 40px;
  left: 0;
  background: white;
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.menu-content a {
  display: block;
  padding: 8px;
  color: #333;
  text-decoration: none;
  border-bottom: 1px solid #eee;
}

.menu-content a:last-child {
  border-bottom: none;
}

.menu-content a:hover {
  background-color: #f0f0f0;
}
.flash-messages {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 10000;
  direction: rtl;
  text-align: right;
}

.flash-messages .alert {
  background-color: #28a745;
  color: white;
  padding: 10px 15px;
  margin-bottom: 8px;
  border-radius: 8px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  font-size: 14px;
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}



  
  </style>
</head>





 
<body>
   
<header class="header">
  <!-- ✅ الشعار والنص في أقصى اليمين -->
  <div class="logo-section">
    <img src="/images/12.png" alt="شعار" class="logo">
    <span class="welcome-text">مرحبًا بكم</span>
  </div>

  <!-- ✅ أزرار في وسط الصفحة -->
  <nav class="nav-links">
    <a href="#" onclick="showSection('home')">الرئيسية</a>
    <a href="#" onclick="showSection('products')">المنتجات</a>
    <a href="#" onclick="showSection('contact')">اتصل بنا</a>
  </nav>

   <!-- ✅ أقصى اليسار: المستخدم والسلة -->
  <div style="display: flex; align-items: center; gap: 10px;">

    {% if session.get('user_email') %}
    <div style="position: relative;">
      <button onclick="toggleMenu()">👤</button>
      <div id="menu" style="display: none; position: absolute; top: 35px; right: 0; background: white; border: 1px solid #ccc; padding: 10px;">
        <a href="/my_orders">my orders</a><br>
        <a href="/logout">logout</a>
        <li><a href="/profile">👤 profile</a></li>

      </div>
    </div>
    {% else %}
    <button onclick="location.href='/login'">تسجيل الدخول</button>
    <button onclick="location.href='/register'">تسجيل جديد</button>
    {% endif %}

    <!-- السلة -->
    <div onclick="window.location.href='/cart'" style="position: relative; cursor: pointer;">
      <img src="/images/c.png" alt="سلة" style="height: 30px;">
      <span id="cart-count" style="position: absolute; top: -5px; left: -10px; background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 12px;">0</span>
    </div>

  </div>
</header>





  <!-- القسم الرئيسي -->
  <section id="home" class="container">
    <h1>مرحبًا بك في متجرنا – عالم التسوق بين يديك!</h1>
    <p>
      في متجرنا، نحن ملتزمون بتقديم أفضل تجربة تسوق إلكتروني. نوفر لك جميع المنصات وأحدث المنتجات التي تحتاجها،
      بدءًا من الألعاب الرقمية، بطاقات الهدايا، وصولاً إلى الاشتراكات المميزة. يمكنك الآن التسوق بكل سهولة وأمان،
      مع خيارات دفع متعددة تشمل بطاقة الفيزا، PayPal، وبريد موب.
    </p>
    <p>
      نؤمن بأن رضاك هو أولويتنا، ولذلك نحرص على تقديم دعم فني متميز وخدمات رقمية فورية. انضم إلينا اليوم واكتشف
      عالمًا من المنتجات والخدمات المصممة خصيصًا لتلبية احتياجاتك.
    </p>
    <a href="#" onclick="showSection('products')" class="cta-button">ابدأ التسوق الآن</a>
  </section>

  <!-- صندوق الملاحظة -->
  <div class="notice-box">
    📌 <strong>ملاحظة هامة:</strong> سيتم إرسال المنتج إلى بريدك الإلكتروني خلال نصف ساعة إلى ساعة بعد إكمال الدفع.
  </div>

  {% if general_notice %}
  <div style="background-color: {{ general_notice.color }}; color: white; text-align: center; padding: 10px; font-weight: bold;">
    {{ general_notice.text }}
  </div>
{% endif %}

  <!-- قسم المنتجات -->
  <section id="products" class="container" style="display: none;">
   

    <h2>منتجاتنا</h2>
    <!-- مربع البحث عن المنتجات -->
    <input type="text" id="searchBox" placeholder="ابحث عن منتج..." oninput="searchProducts()">

       {% include 'partials/products.html' %}
      
  </section>

  <!-- قسم التواصل -->
  <section id="contact" class="container" style="display: none;">
    <h2>اتصل بنا</h2>
    <p>يمكنك التواصل معنا عبر البريد الإلكتروني: gamesbeststore9@gmail.com</p>
  </section>







  <!-- سكربتات جافا سكربت -->
   <script>
  // ✅ لتحديث العداد عند تحميل الصفحة
  document.addEventListener('DOMContentLoaded', function () {
    const countElement = document.getElementById('cart-count');
    const cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    countElement.textContent = cartItems.length;
  });

  // ✅ إشعار بسيط بديل عن alert
  function showNotification(message) {
    const notif = document.createElement('div');
    notif.textContent = message;
    notif.style.position = 'fixed';
    notif.style.bottom = '20px';
    notif.style.right = '20px';
    notif.style.padding = '10px 15px';
    notif.style.backgroundColor = '#28a745';
    notif.style.color = 'white';
    notif.style.borderRadius = '8px';
    notif.style.boxShadow = '0 2px 6px rgba(0,0,0,0.3)';
    notif.style.fontSize = '14px';
    notif.style.zIndex = '10000';
    notif.style.opacity = '0.95';
    notif.style.transition = 'opacity 0.5s ease';

    document.body.appendChild(notif);

    setTimeout(() => {
      notif.style.opacity = '0';
      setTimeout(() => notif.remove(), 500);
    }, 1500);
  }

  // ✅ الدالة المعدّلة
  function addToCart(code) {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    if (!cart.includes(code)) {
      cart.push(code);
      localStorage.setItem('cart', JSON.stringify(cart));

      // تحديث العدد
      document.getElementById('cart-count').textContent = cart.length;

      // إشعار
      showNotification("✅ تمت إضافة المنتج إلى السلة");
    } else {
      showNotification("⚠️ المنتج موجود في السلة");
    }
  }


   function buyNow(productName, price) {
  localStorage.setItem('cart', JSON.stringify([productName]));
  window.location.href = '/checkout'; 
}


    function updateCartButton() {
      const cartButton = document.getElementById('cart');
      if (cartButton) {
        cartButton.innerHTML = `🛒 سلة المشتريات (${cart.length})`;
      }
    }

    function renderCart() {
      const cartContainer = document.getElementById('cart-items');
      if (cartContainer) {
        cartContainer.innerHTML = "";
        cart.forEach(item => {
          const div = document.createElement('div');
          div.textContent = `${item.id} - ${item.price} دج`;
          cartContainer.appendChild(div);
        });
      }
    }

    // عند تحميل الصفحة
    updateCartButton();
    renderCart();

  // عند تحميل الصفحة
  document.addEventListener('DOMContentLoaded', function () {
    updateCartButton(); // تحديث عداد السلة فقط كبداية
  });

// استدعاء تحديث زر السلة عند تحميل الصفحة
updateCartButton();
    // البحث عن المنتجات
    function searchProducts() {
      const searchValue = document.getElementById('searchBox').value.toLowerCase();
      const products = document.querySelectorAll('#products .product, #products .product-container');
      products.forEach(product => {
        // نحاول التقاط اسم المنتج سواء كان داخل h3 أو داخل عنصر بالصف class="product-title"
        const nameElem = product.querySelector('h3') || product.querySelector('.product-title');
        const productName = nameElem.textContent.toLowerCase();
        if (productName.includes(searchValue)) {
          product.style.display = 'inline-block';
        } else {
          product.style.display = 'none';
        }
      });
    }

    // تحويل الأسعار من الدولار إلى الدينار الجزائري
    const exchangeRate = 250;
    function convertPrices() {
      document.querySelectorAll('.usd-price, .product-price').forEach(priceElement => {
        const priceInUSD = parseFloat(priceElement.dataset.usd);
        const priceInDZD = (priceInUSD * exchangeRate).toFixed(0);
        // نضيف السعر بالدينار بجانب السعر بالدولار إذا لم يكن موجودًا مسبقًا
        if (!priceElement.textContent.includes("دج")) {
          priceElement.innerHTML += ` (${priceInDZD} دج)`;
        }
      });
    }

    // التحقق من تسجيل الدخول وإظهار/إخفاء الأزرار المناسبة
    function checkLogin() {
      const storedUsername = localStorage.getItem('username');
      if (storedUsername) {
        document.getElementById('login-btn').style.display = 'none';
        document.getElementById('register-btn').style.display = 'none';
        document.getElementById('user-info').style.display = 'block';
        document.getElementById('username').textContent = storedUsername;
      }
    }

    // دالة تسجيل الخروج (موحدة)
    function logout() {
      localStorage.removeItem('username');
      localStorage.removeItem('password');
      window.location.reload();
    }

    // دمج عمليات تحميل الصفحة لتفادي التكرار
    window.onload = function() {
      updateCartButton();
      convertPrices();
      checkLogin();
    };

    function showSection(sectionId) {
  // إخفاء جميع الأقسام الرئيسية
  document.querySelectorAll('section').forEach(sec => {
    sec.style.display = 'none';
  });
  // إظهار القسم المطلوب فقط
  const section = document.getElementById(sectionId);
  if (section) {
    section.style.display = 'block';
  }
}

function toggleMenu() {
  const menu = document.getElementById("menu");
  if (menu.style.display === "block") {
    menu.style.display = "none";
  } else {
    menu.style.display = "block";
  }
}



  </script>
</body>
</html>
